# 因果推断教程

## 前言

欢迎来到因果推断教程！本教程专为具有编程和AI背景的技术人员设计，旨在系统地介绍因果推断的核心概念、方法和实践应用。

在机器学习和人工智能快速发展的今天，我们不仅需要预测"会发生什么"，更需要理解"为什么会发生"以及"如果我们采取行动会发生什么"。因果推断为我们提供了回答这些问题的严格框架。

## 本教程特色

- **理论与实践并重**：每个概念都配有详细解释和实际应用场景
- **大量练习题**：每章包含6-8道精心设计的习题，涵盖基础理解和深度思考
- **常见陷阱提醒**：总结每个主题的常见错误和误区
- **最佳实践指南**：提供实际应用中的检查清单

## 目标读者

本教程假设读者具备：
- 扎实的编程基础
- 概率论和统计学基础知识
- 机器学习基本概念
- 线性代数基础

## 章节目录

### [第一章：因果推断导论](chapter1.md)
- 相关性与因果性的本质区别
- 为什么需要因果推断
- 因果推断的历史发展
- 三个层级的因果问题
- **行业案例**：Netflix推荐算法中的辛普森悖论

### [第二章：潜在结果框架](chapter2.md)
- Rubin因果模型
- 因果效应的定义
- 基本问题与识别假设
- SUTVA假设
- **行业案例**：Uber动态定价的因果效应评估

### [第三章：图模型与因果图](chapter3.md)
- 有向无环图（DAG）基础
- d-分离准则
- 后门准则与前门准则
- 因果图的构建方法
- **行业案例**：阿里巴巴广告归因模型的因果图设计

### [第四章：随机实验与因果识别](chapter4.md)
- 随机对照试验（RCT）
- 完全随机化与分层随机化
- 合规性与意向性治疗分析
- 实验设计的局限性
- **行业案例**：Facebook的社交网络A/B测试

### [第五章：观察性研究中的因果推断](chapter5.md)
- 混杂因素与选择偏差
- 倾向得分方法
- 匹配方法
- 逆概率加权
- **行业案例**：LinkedIn职业发展路径分析

### [第六章：工具变量方法](chapter6.md)
- 工具变量的定义与假设
- 两阶段最小二乘法
- 弱工具变量问题
- 局部平均处理效应（LATE）
- **行业案例**：滴滴出行补贴政策效果评估

### [第七章：断点回归设计](chapter7.md)
- 精确断点回归
- 模糊断点回归
- 带宽选择与稳健性检验
- 应用案例分析
- **行业案例**：拼多多用户等级制度的效果分析

### [第八章：双重差分方法](chapter8.md)
- DiD的基本原理
- 平行趋势假设
- 事件研究设计
- 交错处理时间的处理
- **行业案例**：美团外卖配送费调整的影响评估

### [第九章：中介分析与路径分析](chapter9.md)
- 直接效应与间接效应
- 中介效应的识别
- 敏感性分析
- 多重中介模型
- **行业案例**：字节跳动内容质量对用户留存的影响机制

### [第十章：异质性处理效应](chapter10.md)
- 条件平均处理效应（CATE）
- 因果森林与因果树
- 元学习方法
- 个体化治疗规则
- **行业案例**：京东个性化促销策略优化

### [第十一章：时间序列因果推断](chapter11.md)
- 格兰杰因果
- 向量自回归模型
- 合成控制方法
- 因果影响分析
- **行业案例**：Google搜索趋势与股价预测

### [第十二章：因果发现](chapter12.md)
- 基于约束的方法（PC算法）
- 基于分数的方法
- 连续优化方法
- 因果发现的评估
- **行业案例**：华为5G网络故障根因分析

### [第十三章：反事实推理与结构因果模型](chapter13.md)
- Pearl因果层级
- 结构因果模型（SCM）
- 反事实查询
- 必要性与充分性概率
- **行业案例**：特斯拉自动驾驶事故责任判定

### [第十四章：因果推断与机器学习](chapter14.md)
- 因果正则化
- 因果表示学习
- 因果强化学习
- 公平性与因果推断
- **行业案例**：微软Azure资源调度的因果强化学习

### [第十五章：实践案例与工具](chapter15.md)
- Python因果推断库介绍
- A/B测试中的因果推断
- 推荐系统中的因果思维
- 医疗健康应用案例
- **行业案例**：腾讯游戏玩家流失预测与干预

## 学习建议

1. **循序渐进**：建议按章节顺序学习，每章概念都建立在前面章节的基础上
2. **动手实践**：完成每章的练习题，特别是挑战题部分
3. **批判思考**：注意每章的"常见陷阱"部分，避免常见误区
4. **实际应用**：尝试将学到的方法应用到自己的实际问题中

## 参考资源

### 推荐书籍
- Pearl, J. (2009). *Causality: Models, Reasoning, and Inference*
- Imbens, G. W., & Rubin, D. B. (2015). *Causal Inference for Statistics, Social, and Biomedical Sciences*
- Peters, J., Janzing, D., & Schölkopf, B. (2017). *Elements of Causal Inference*

### 在线课程
- Brady Neal's Causal Inference Course
- MIT's Causal Inference Course
- Stanford's Causal Inference Course

### 工具与库
- **Python**: DoWhy, CausalML, EconML, pgmpy
- **R**: CausalImpact, grf, MatchIt
- **通用**: DAGitty, Tetrad

## 符号约定

本教程使用以下符号约定：
- $Y$：结果变量
- $T$ 或 $D$：处理变量
- $X$：协变量
- $U$：未观测的混杂因素
- $Y(1), Y(0)$：潜在结果
- $E[\cdot]$：期望值
- $P(\cdot)$：概率
- $\tau$：处理效应
- $\perp\!\!\!\perp$：独立性

## 开始学习

准备好了吗？让我们从[第一章：因果推断导论](chapter1.md)开始，探索因果推断的奇妙世界！

---

*本教程持续更新中，欢迎反馈和建议。*